<!DOCTYPE html>
<html>
<head>
<title>gsapp</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<!--
<link rel="stylesheet" href="//esri.github.io/calcite-bootstrap/assets/css/calcite-bootstrap.css">
<link rel="stylesheet" href="//js.arcgis.com/3.21/esri/themes/calcite/dijit/calcite.css">
<link rel="stylesheet" href="//js.arcgis.com/3.21/esri/css/esri.css">
-->
<link rel="stylesheet" href="//js.arcgis.com/3.23/esri/themes/calcite/dijit/calcite.css">
<link rel="stylesheet" href="//js.arcgis.com/3.23/esri/css/esri.css">
<link rel="stylesheet" href="../widget/style/style.css">
<script>
  var dojoConfig = {
    locale: "en",
    async: true,
    parseOnLoad: true,
    packages: [
      {
        name: "gs",
        location: location.pathname.replace(/\/[^/]*$/,"") + "/../../gs",
      }
    ]
  };
</script>
</head>
<body class="calcite">
<div style="top:20px;left:20px;">
  <div id="idSearch" style="display:inline-block;"></div>
  <div id="idMap" style="display:inline-block;width:400px;height:400px;vertical-align: top;"></div>
</div>
<script src="https://js.arcgis.com/3.23/"></script>
<!--
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
-->
<script>
  require(["dojo/ready",
    "esri/map",
    "gs/widget/SearchPane",
    "gs/widget/WidgetContext",
    "dojo/i18n!gs/widget/nls/strings",
    "gs/widget/TestSearch",
    "gs/widget/LayerLoader",
    "esri/config"],
  function(ready,Map,SearchPane,WidgetContext,i18n,TestSearch,LayerLoader,esriConfig) {
    ready(function() {
      if (document.location.href.indexOf("test=true") === -1) {
        esriConfig.defaults.io.proxyUrl = "http://gptdb1.esri.com:8080/geoportal/viewer/proxy.jsp";
        esriConfig.defaults.io.alwaysUseProxy = false;
        var map = window.map = new Map("idMap", {
          center: [-118, 34.5],
          zoom: 8,
          basemap: "topo"
        });
        var widgetContext = new WidgetContext({
          i18n: i18n,
          map: map,
          widgetFolder: "gs/widget",
        });
        var searchPane = new SearchPane({
          i18n: i18n,
          widgetContext: widgetContext
        },"idSearch");
        searchPane.startup();
        var layerLoader = new LayerLoader({
          i18n: i18n,
          map: map
        });
        //layerLoader.addFeatureService("http://services.arcgis.com/P3ePLMYs2RVChkJx/arcgis/rest/services/USA_States_Generalized/FeatureServer/0");
      } else {
        new TestSearch({},"idSearch");
      }
    });
  });
</script>
</body>
</html>
